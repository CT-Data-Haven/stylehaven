<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Choose label colors based on contrast — contrast_colors • stylehaven</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Choose label colors based on contrast — contrast_colors"><meta name="description" content="This is a set of utility functions and classes for a situation that I too often gloss over: when making a chart with different fill colors (such as stacked bars with a sequential palette), it can be good to vary the label color to maintain good contrast between the background and foreground. For example, the ColorBrewer palettes often go from such a dark color to such a light color that black or dark gray labels won't be visible over the darkest bar, and white or light gray labels won't be visible over the lightest bar. This helps prepare for that by testing the contrast between a palette (presumably bar fill colors) and a light and dark option (presumably label text on those bars).
A contrast ratio is calculated by colorspace::contrast_ratio according to the WCAG algorithm, and the minimum ratio defaults to 4.5 based on their accessibility guidelines. If verbose is true and any combination of palette color and label colors fails to meet this minimum, you'll get a message letting you know. For example, using medium gray colors for both dark and light labels is likely to lead to a situation where neither the dark nor the light label color would have enough contrast over the palette.
mutate_contrast takes this a step further, working with a data frame to determine label colors from a factor column (or a column that can become a factor).
plot methods create ggplot plots as visual references of the fill and label colors. For cc_df objects, there will be two columns of fill + label combinations with their ratios and a star for the label color with the greatest contrast. For cc_vec objects, this is a simplified version giving just one column of fills and the label colors with greatest contrast, but no ratio information."><meta property="og:description" content="This is a set of utility functions and classes for a situation that I too often gloss over: when making a chart with different fill colors (such as stacked bars with a sequential palette), it can be good to vary the label color to maintain good contrast between the background and foreground. For example, the ColorBrewer palettes often go from such a dark color to such a light color that black or dark gray labels won't be visible over the darkest bar, and white or light gray labels won't be visible over the lightest bar. This helps prepare for that by testing the contrast between a palette (presumably bar fill colors) and a light and dark option (presumably label text on those bars).
A contrast ratio is calculated by colorspace::contrast_ratio according to the WCAG algorithm, and the minimum ratio defaults to 4.5 based on their accessibility guidelines. If verbose is true and any combination of palette color and label colors fails to meet this minimum, you'll get a message letting you know. For example, using medium gray colors for both dark and light labels is likely to lead to a situation where neither the dark nor the light label color would have enough contrast over the palette.
mutate_contrast takes this a step further, working with a data frame to determine label colors from a factor column (or a column that can become a factor).
plot methods create ggplot plots as visual references of the fill and label colors. For cc_df objects, there will be two columns of fill + label combinations with their ratios and a star for the label color with the greatest contrast. For cc_vec objects, this is a simplified version giving just one column of fills and the label colors with greatest contrast, but no ratio information."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">stylehaven</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/stylehaven.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CT-Data-Haven/stylehaven/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Choose label colors based on contrast</h1>
      <small class="dont-index">Source: <a href="https://github.com/CT-Data-Haven/stylehaven/blob/main/R/contrast_colors.R" class="external-link"><code>R/contrast_colors.R</code></a></small>
      <div class="d-none name"><code>contrast_colors.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This is a set of utility functions and classes for a situation that I too often gloss over: when making a chart with different fill colors (such as stacked bars with a sequential palette), it can be good to vary the label color to maintain good contrast between the background and foreground. For example, the ColorBrewer palettes often go from such a dark color to such a light color that black or dark gray labels won't be visible over the darkest bar, and white or light gray labels won't be visible over the lightest bar. This helps prepare for that by testing the contrast between a palette (presumably bar fill colors) and a light and dark option (presumably label text on those bars).</p>
<p>A contrast ratio is calculated by <code><a href="https://colorspace.R-Forge.R-project.org/reference/contrast_ratio.html" class="external-link">colorspace::contrast_ratio</a></code> according to the WCAG algorithm, and the minimum ratio defaults to 4.5 based on their accessibility guidelines. If <code>verbose</code> is true and any combination of palette color and label colors fails to meet this minimum, you'll get a message letting you know. For example, using medium gray colors for both dark and light labels is likely to lead to a situation where neither the dark nor the light label color would have enough contrast over the palette.</p>
<p><code>mutate_contrast</code> takes this a step further, working with a data frame to determine label colors from a factor column (or a column that can become a factor).</p>
<p><code>plot</code> methods create <code>ggplot</code> plots as visual references of the fill and label colors. For <code>cc_df</code> objects, there will be two columns of fill + label combinations with their ratios and a star for the label color with the greatest contrast. For <code>cc_vec</code> objects, this is a simplified version giving just one column of fills and the label colors with greatest contrast, but no ratio information.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">contrast_colors</span><span class="op">(</span></span>
<span>  <span class="va">pal</span>,</span>
<span>  dark <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  light <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  min_ratio <span class="op">=</span> <span class="fl">4.5</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  labels_only <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  reverse <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">mutate_contrast</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">col</span>,</span>
<span>  <span class="va">pal</span>,</span>
<span>  dark <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  light <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>  min_ratio <span class="op">=</span> <span class="fl">4.5</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  reverse <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'cc_df'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'cc_vec'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'cc_df'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'cc_vec'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="source">Source<a class="anchor" aria-label="anchor" href="#source"></a></h2>
    <p><a href="https://www.w3.org/TR/UNDERSTANDING-WCAG20/visual-audio-contrast-contrast.html" class="external-link">https://www.w3.org/TR/UNDERSTANDING-WCAG20/visual-audio-contrast-contrast.html</a></p>
    </div>
    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pal">pal<a class="anchor" aria-label="anchor" href="#arg-pal"></a></dt>
<dd><p>String: either a vector of colors (either named R colors or hex codes), or the name of a palette from the <code>RColorBrewer</code>, <code>rcartocolor</code>, or <code>viridisLite</code> packages. If the name of a palette, the respective function will be called to fetch the vector of hex codes.</p></dd>


<dt id="arg-dark">dark<a class="anchor" aria-label="anchor" href="#arg-dark"></a></dt>
<dd><p>String giving a single valid color to use as the dark label option, either a named R color or hex code. Default: 'black'</p></dd>


<dt id="arg-light">light<a class="anchor" aria-label="anchor" href="#arg-light"></a></dt>
<dd><p>String giving a single valid color to use as the light label option, either a named R color or hex code. Default: 'white'</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>For <code>contrast_colors</code>, if <code>pal</code> is the name of a palette, its corresponding palette will have <code>n</code> colors. Ignored otherwise. For <code>mutate_contrast</code>, this is determined by the number of levels in <code>col</code>. Default: 5</p></dd>


<dt id="arg-min-ratio">min_ratio<a class="anchor" aria-label="anchor" href="#arg-min-ratio"></a></dt>
<dd><p>Minimum contrast ratio, below which a pair of colors is deemed low-contrast. If <code>verbose</code> is true and any sets of colors fail to meet this minimum, you'll get a diagnostic message letting you know. Default: 4.5</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical, whether to print diagnostic info if there are issues with your contrast ratios, Default: TRUE</p></dd>


<dt id="arg-labels-only">labels_only<a class="anchor" aria-label="anchor" href="#arg-labels-only"></a></dt>
<dd><p>Logical, whether to return only labels, i.e. just a vector of the dark or light values, depending on which had the greatest contrast for each color in <code>pal</code>, or the full data frame used for calculations, including all ratios. Default: TRUE</p></dd>


<dt id="arg-reverse">reverse<a class="anchor" aria-label="anchor" href="#arg-reverse"></a></dt>
<dd><p>Boolean: if <code>TRUE</code>, palette will be reversed. This mostly only matters for <code>mutate_contrast</code>, as it determines which colors are associated with which factor levels. Default: FALSE</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>Logical, whether to print a <code>ggplot</code> swatch of tiles filled with <code>pal</code> and labels, using <code>plot</code> methods for the appropriate class. Doesn't change the return value. Default: FALSE</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame</p></dd>


<dt id="arg-col">col<a class="anchor" aria-label="anchor" href="#arg-col"></a></dt>
<dd><p>Bare name of a column in <code>x</code> along which the palette will be mapped. If not already a factor, it will be coerced into one with levels in the same order in which they appear.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>For methods: An object returned by <code>contrast_colors</code></p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Not currently used</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>

<ul><li><p>For <code>contrast_colors</code>: If <code>labels_only</code>, a named character vector of colors, either the value of <code>dark</code> or <code>light</code>, giving the highest contrast ratio for each value of <code>pal</code>. This will be the same length as <code>pal</code> (or <code>n</code>, if you gave <code>pal</code> as the name of a palette to retrieve), and the names will be the fill colors. Otherwise, a data frame with the same number of rows as colors in <code>pal</code> and 6 columns of info about them, including fill and label colors (see examples).</p><ul><li><p>If <code>labels_only = FALSE</code>, will also have the classes <code>contrast_colors</code> and <code>cc_df</code></p></li>
<li><p>If <code>labels_only = TRUE</code>, will also have the classes <code>contrast_colors</code> and <code>cc_vec</code>.</p></li>
</ul></li>
<li><p>For <code>mutate_contrast</code>, the original data frame given as <code>data</code>, with columns added for fill (according to <code>palette</code>) and label color.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://colorspace.R-Forge.R-project.org/reference/contrast_ratio.html" class="external-link">colorspace::contrast_ratio()</a></code>, <code><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">RColorBrewer::brewer.pal()</a></code>, <code><a href="https://jakubnowosad.com/rcartocolor/reference/carto_pal.html" class="external-link">rcartocolor::carto_pal()</a></code>, <code><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridisLite::viridis()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># using a pre-defined palette</span></span></span>
<span class="r-in"><span><span class="va">qual_pal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#009B9E"</span>, <span class="st">"#DAA51B"</span>, <span class="st">"#C75DAB"</span>, <span class="st">"#898DA7"</span>, <span class="st">"#2A39A7"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">contrast_colors</span><span class="op">(</span><span class="va">qual_pal</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #009B9E #DAA51B #C75DAB #898DA7 #2A39A7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "black" "black" "black" "black" "white" </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># returning a data frame</span></span></span>
<span class="r-in"><span><span class="fu">contrast_colors</span><span class="op">(</span><span class="va">qual_pal</span>, labels_only <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      fill dark light  max lbl_color low_contrast</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 #009B9E 6.18  3.40 6.18     black        FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 #DAA51B 9.38  2.24 9.38     black        FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 #C75DAB 5.58  3.76 5.58     black        FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 #898DA7 6.43  3.27 6.43     black        FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 #2A39A7 2.24  9.37 9.37     white        FALSE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># printing the plot, brewer palette</span></span></span>
<span class="r-in"><span><span class="fu">contrast_colors</span><span class="op">(</span><span class="st">"YlGnBu"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="contrast_colors-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #FFFFCC #A1DAB4 #41B6C4 #2C7FB8 #253494 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "black" "black" "black" "black" "white" </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># not enough contrast, carto palette</span></span></span>
<span class="r-in"><span><span class="fu">contrast_colors</span><span class="op">(</span><span class="st">"Vivid"</span>, n <span class="op">=</span> <span class="fl">7</span>, dark <span class="op">=</span> <span class="st">"gray40"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #BBBB00;">!</span> At least one set of colors failed to meet the minimum contrast threshold of</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   4.5.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Consider adjusting the palette and/or using more distinct label colors.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> For #E58606, color #1, ratio to `dark` is 2.12; ratio to `light` is 2.71.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> For #52BCA3, color #3, ratio to `dark` is 2.48; ratio to `light` is 2.31.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> For #99C945, color #4, ratio to `dark` is 2.95; ratio to `light` is 1.95.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> For #CC61B0, color #5, ratio to `dark` is 1.61; ratio to `light` is 3.56.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> For #A5AA99, color #7, ratio to `dark` is 2.41; ratio to `light` is 2.38.</span>
<span class="r-plt img"><img src="contrast_colors-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  #E58606  #5D69B1  #52BCA3  #99C945  #CC61B0  #24796C  #A5AA99 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  "white"  "white" "gray40" "gray40"  "white"  "white" "gray40" </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use mutate_contrast to get color information attached to your data frame</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">health</span> <span class="op">&lt;-</span> <span class="va">self_rated_health</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu">mutate_contrast</span><span class="op">(</span>col <span class="op">=</span> <span class="va">response</span>, pal <span class="op">=</span> <span class="st">"BuGn"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use same palette for fill scale</span></span></span>
<span class="r-in"><span><span class="co"># lbl_color column has colors to use, so can use identity scale</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">health</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">response</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_stack.html" class="external-link">position_fill</a></span><span class="op">(</span>reverse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="number_formats.html">percent100</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>, group <span class="op">=</span> <span class="va">group</span>, color <span class="op">=</span> <span class="va">lbl_color</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_stack.html" class="external-link">position_fill</a></span><span class="op">(</span>reverse <span class="op">=</span> <span class="cn">TRUE</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"BuGn"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_identity.html" class="external-link">scale_color_identity</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="contrast_colors-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># could actually use scale_fill_identity as well, since fill colors are in data,</span></span></span>
<span class="r-in"><span><span class="co"># but it becomes messy when you want a legend</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># now use a manual palette, and give the same set of colors to scale_fill_manual</span></span></span>
<span class="r-in"><span><span class="va">manual_pal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#005CE7"</span>, <span class="st">"#9C45C7"</span>, <span class="st">"#CC6697"</span>, <span class="st">"#E69259"</span>, <span class="st">"#F2D25C"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">health_w_pal</span> <span class="op">&lt;-</span> <span class="va">self_rated_health</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu">mutate_contrast</span><span class="op">(</span>col <span class="op">=</span> <span class="va">response</span>, pal <span class="op">=</span> <span class="va">manual_pal</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">health_w_pal</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">response</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_stack.html" class="external-link">position_fill</a></span><span class="op">(</span>reverse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="number_formats.html">percent100</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>, group <span class="op">=</span> <span class="va">group</span>, color <span class="op">=</span> <span class="va">lbl_color</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_stack.html" class="external-link">position_fill</a></span><span class="op">(</span>reverse <span class="op">=</span> <span class="cn">TRUE</span>, vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">manual_pal</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_identity.html" class="external-link">scale_color_identity</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="contrast_colors-4.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Camille Seaberry.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

