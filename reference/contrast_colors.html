<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This is a pair of utility functions for a situation that I too often gloss over: when making a chart with different fill colors (such as stacked bars with a sequential palette), it can be good to vary the label color to maintain good contrast between the background and foreground. For example, the ColorBrewer palettes often go from such a dark color to such a light color that black or dark gray labels won't be visible over the darkest bar, and white or light gray labels won't be visible over the lightest bar. This helps prepare for that by testing the contrast between a palette (presumably bar fill colors) and a light and dark option (presumably label text on those bars).
A contrast ratio is calculated by colorspace::contrast_ratio according to the WCAG algorithm, and the minimum ratio defaults to 4.5 based on their accessibility guidelines. If verbose is true and any combination of palette color and label colors fails to meet this minimum, you'll get a message letting you know. For example, using medium gray colors for both dark and light labels is likely to lead to a situation where neither the dark nor the light label color would have enough contrast over the palette.
mutate_contrast takes this a step further, working with a data frame to determine label colors from a factor column (or a column that can become a factor)."><title>Choose label colors based on contrast — contrast_colors • stylehaven</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Open_Sans-0.4.8/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Choose label colors based on contrast — contrast_colors"><meta property="og:description" content="This is a pair of utility functions for a situation that I too often gloss over: when making a chart with different fill colors (such as stacked bars with a sequential palette), it can be good to vary the label color to maintain good contrast between the background and foreground. For example, the ColorBrewer palettes often go from such a dark color to such a light color that black or dark gray labels won't be visible over the darkest bar, and white or light gray labels won't be visible over the lightest bar. This helps prepare for that by testing the contrast between a palette (presumably bar fill colors) and a light and dark option (presumably label text on those bars).
A contrast ratio is calculated by colorspace::contrast_ratio according to the WCAG algorithm, and the minimum ratio defaults to 4.5 based on their accessibility guidelines. If verbose is true and any combination of palette color and label colors fails to meet this minimum, you'll get a message letting you know. For example, using medium gray colors for both dark and light labels is likely to lead to a situation where neither the dark nor the light label color would have enough contrast over the palette.
mutate_contrast takes this a step further, working with a data frame to determine label colors from a factor column (or a column that can become a factor)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">stylehaven</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/dcws_example_plots.html">Plot examples from the DCWS launch</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/CT-Data-Haven/stylehaven/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Choose label colors based on contrast</h1>
      <small class="dont-index">Source: <a href="https://github.com/CT-Data-Haven/stylehaven/blob/HEAD/R/contrast_colors.R" class="external-link"><code>R/contrast_colors.R</code></a></small>
      <div class="d-none name"><code>contrast_colors.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This is a pair of utility functions for a situation that I too often gloss over: when making a chart with different fill colors (such as stacked bars with a sequential palette), it can be good to vary the label color to maintain good contrast between the background and foreground. For example, the ColorBrewer palettes often go from such a dark color to such a light color that black or dark gray labels won't be visible over the darkest bar, and white or light gray labels won't be visible over the lightest bar. This helps prepare for that by testing the contrast between a palette (presumably bar fill colors) and a light and dark option (presumably label text on those bars).</p>
<p>A contrast ratio is calculated by <code><a href="https://colorspace.R-Forge.R-project.org/reference/contrast_ratio.html" class="external-link">colorspace::contrast_ratio</a></code> according to the WCAG algorithm, and the minimum ratio defaults to 4.5 based on their accessibility guidelines. If <code>verbose</code> is true and any combination of palette color and label colors fails to meet this minimum, you'll get a message letting you know. For example, using medium gray colors for both dark and light labels is likely to lead to a situation where neither the dark nor the light label color would have enough contrast over the palette.</p>
<p><code>mutate_contrast</code> takes this a step further, working with a data frame to determine label colors from a factor column (or a column that can become a factor).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">contrast_colors</span><span class="op">(</span></span>
<span>  <span class="va">pal</span>,</span>
<span>  dark <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  light <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  min_ratio <span class="op">=</span> <span class="fl">4.5</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  labels_only <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">mutate_contrast</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">col</span>,</span>
<span>  <span class="va">pal</span>,</span>
<span>  dark <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  light <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>  min_ratio <span class="op">=</span> <span class="fl">4.5</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="source">Source<a class="anchor" aria-label="anchor" href="#source"></a></h2>
    <p><a href="https://www.w3.org/TR/UNDERSTANDING-WCAG20/visual-audio-contrast-contrast.html" class="external-link">https://www.w3.org/TR/UNDERSTANDING-WCAG20/visual-audio-contrast-contrast.html</a></p>
    </div>
    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>pal</dt>
<dd><p>String: either a vector of colors (either named R colors or hex codes), or the name of a palette from the <code>RColorBrewer</code>, <code>rcartocolor</code>, or <code>viridisLite</code> packages. If the name of a palette, the respective function will be called to fetch the vector of hex codes.</p></dd>


<dt>dark</dt>
<dd><p>String giving a single valid color to use as the dark label option, either a named R color or hex code. Default: 'black'</p></dd>


<dt>light</dt>
<dd><p>String giving a single valid color to use as the light label option, either a named R color or hex code. Default: 'white'</p></dd>


<dt>n</dt>
<dd><p>For <code>contrast_colors</code>, if <code>pal</code> is the name of a palette, its corresponding palette will have <code>n</code> colors. Ignored otherwise. For <code>mutate_contrast</code>, this is determined by the number of levels in <code>col</code>. Default: 5</p></dd>


<dt>min_ratio</dt>
<dd><p>Minimum contrast ratio, below which a pair of colors is deemed low-contrast. If <code>verbose</code> is true and any sets of colors fail to meet this minimum, you'll get a diagnostic message letting you know. Default: 4.5</p></dd>


<dt>verbose</dt>
<dd><p>Logical, whether to print diagnostic info if there are issues with your contrast ratios, Default: TRUE</p></dd>


<dt>labels_only</dt>
<dd><p>Logical, whether to return only labels, i.e. just a vector of the dark or light values, depending on which had the greatest contrast for each color in <code>pal</code>, or the full data frame used for calculations, including all ratios. Default: TRUE</p></dd>


<dt>plot</dt>
<dd><p>Logical, whether to print a <code>ggplot</code> swatch of tiles filled with <code>pal</code> and labels in both the dark and light label colors. For each fill color, the label color with the highest contrast ratio will be starred, although highest might not be above the minimum required. Doesn't change the return value. Default: FALSE</p></dd>


<dt>x</dt>
<dd><p>A data frame</p></dd>


<dt>col</dt>
<dd><p>Bare name of a column in <code>x</code> along which the palette will be mapped. If not already a factor, it will be coerced into one with levels in the same order in which they appear.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>For <code>contrast_colors</code>: If <code>labels_only</code>, a named character vector of colors, either the value of <code>dark</code> or <code>light</code>, giving the highest contrast ratio for each value of <code>pal</code>. This will be the same length as <code>pal</code> (or <code>n</code>, if you gave <code>pal</code> as the name of a palette to retrieve), and the names will be the fill colors. Otherwise, a data frame with the same number of rows as colors in <code>pal</code> and 6 columns of info about them, including fill and label colors (see examples). For <code>mutate_contrast</code>, the original data frame given as <code>x</code>, with columns added for fill (according to <code>palette</code>) and label color.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://colorspace.R-Forge.R-project.org/reference/contrast_ratio.html" class="external-link">colorspace::contrast_ratio()</a></code>, <code><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">RColorBrewer::brewer.pal()</a></code>, <code><a href="https://rdrr.io/pkg/rcartocolor/man/carto_pal.html" class="external-link">rcartocolor::carto_pal()</a></code>, <code><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridisLite::viridis()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># using a pre-defined palette</span></span></span>
<span class="r-in"><span><span class="va">qual_pal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#009B9E"</span>, <span class="st">"#DAA51B"</span>, <span class="st">"#C75DAB"</span>, <span class="st">"#898DA7"</span>, <span class="st">"#2A39A7"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">contrast_colors</span><span class="op">(</span><span class="va">qual_pal</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #009B9E #DAA51B #C75DAB #898DA7 #2A39A7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "black" "black" "black" "black" "white" </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># returning a data frame</span></span></span>
<span class="r-in"><span><span class="fu">contrast_colors</span><span class="op">(</span><span class="va">qual_pal</span>, labels_only <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      fill dark light  max lbl_color low_contrast</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 #009B9E 6.18  3.40 6.18     black        FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 #DAA51B 9.38  2.24 9.38     black        FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 #C75DAB 5.58  3.76 5.58     black        FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 #898DA7 6.43  3.27 6.43     black        FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 #2A39A7 2.24  9.37 9.37     white        FALSE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># printing the plot, brewer palette</span></span></span>
<span class="r-in"><span><span class="fu">contrast_colors</span><span class="op">(</span><span class="st">"YlGnBu"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="contrast_colors-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #FFFFCC #A1DAB4 #41B6C4 #2C7FB8 #253494 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "black" "black" "black" "black" "white" </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># not enough contrast, carto palette</span></span></span>
<span class="r-in"><span><span class="fu">contrast_colors</span><span class="op">(</span><span class="st">"Vivid"</span>, n <span class="op">=</span> <span class="fl">7</span>, dark <span class="op">=</span> <span class="st">"gray40"</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> At least one set of colors failed to meet the minimum contrast threshold of 4.5. Consider adjusting the palette and/or using more distinct label colors.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • For #E58606, color #1, ratio to `dark` is 2.12; ratio to `light` is 2.71.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • For #52BCA3, color #3, ratio to `dark` is 2.48; ratio to `light` is 2.31.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • For #99C945, color #4, ratio to `dark` is 2.95; ratio to `light` is 1.95.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • For #CC61B0, color #5, ratio to `dark` is 1.61; ratio to `light` is 3.56.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • For #A5AA99, color #7, ratio to `dark` is 2.41; ratio to `light` is 2.38.</span>
<span class="r-plt img"><img src="contrast_colors-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  #E58606  #5D69B1  #52BCA3  #99C945  #CC61B0  #24796C  #A5AA99 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  "white"  "white" "gray40" "gray40"  "white"  "white" "gray40" </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># For a very small data frame, it's possible to assign label colors with </span></span></span>
<span class="r-in"><span><span class="co"># `contrast_colors` directly back into the data frame, then use</span></span></span>
<span class="r-in"><span><span class="co"># `scale_color_identity`. </span></span></span>
<span class="r-in"><span><span class="va">food</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">fin_insecurity</span>, <span class="va">question</span> <span class="op">==</span> <span class="st">"food_insecurity"</span>, </span></span>
<span class="r-in"><span>                      <span class="va">category</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Greater New Haven"</span>, <span class="st">"Age"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">food</span><span class="op">$</span><span class="va">lbl_color</span> <span class="op">&lt;-</span> <span class="fu">contrast_colors</span><span class="op">(</span><span class="va">qual_pal</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">food</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="number_formats.html">percent100</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>, color <span class="op">=</span> <span class="va">lbl_color</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>            vjust <span class="op">=</span> <span class="fl">1</span>, nudge_y <span class="op">=</span> <span class="op">-</span><span class="fl">0.01</span>, fontface <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">qual_pal</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_identity.html" class="external-link">scale_color_identity</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="contrast_colors-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># For a larger data frame, use `mutate_contrast` to get the contrast info</span></span></span>
<span class="r-in"><span><span class="co"># joined back to your data frame. Since this includes the fill colors, you</span></span></span>
<span class="r-in"><span><span class="co"># can use `scale_fill_identity`, but this requires putting your legend back in.</span></span></span>
<span class="r-in"><span><span class="va">health</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">self_rated_health</span>, <span class="va">category</span> <span class="op">==</span> <span class="st">"Age"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">mutate_contrast</span><span class="op">(</span>col <span class="op">=</span> <span class="va">response</span>, pal <span class="op">=</span> <span class="st">"viridis"</span>, dark <span class="op">=</span> <span class="st">"gray10"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">health</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   category group      response  value fill      lbl_color</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> Age      Ages 18-34 Excellent  0.24 #440154FF white    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> Age      Ages 18-34 Very good  0.38 #3B528BFF white    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> Age      Ages 18-34 Good       0.27 #21908CFF black    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> Age      Ages 18-34 Fair       0.1  #5DC863FF black    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> Age      Ages 18-34 Poor       0.01 #FDE725FF black    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> Age      Ages 35-49 Excellent  0.22 #440154FF white    </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">health</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">fill</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_stack.html" class="external-link">position_fill</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="number_formats.html">percent100</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>, color <span class="op">=</span> <span class="va">lbl_color</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>            position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_stack.html" class="external-link">position_fill</a></span><span class="op">(</span>vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, fontface <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_identity.html" class="external-link">scale_color_identity</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_identity.html" class="external-link">scale_fill_identity</a></span><span class="op">(</span>guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">health</span><span class="op">$</span><span class="va">response</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="contrast_colors-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Alternatively, pull out the palette as a named list and pass that to</span></span></span>
<span class="r-in"><span><span class="co"># `scale_fill_manual`.</span></span></span>
<span class="r-in"><span><span class="va">resp_pal</span> <span class="op">&lt;-</span> <span class="va">health</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">response</span>, <span class="va">fill</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html" class="external-link">deframe</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">health</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">response</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_stack.html" class="external-link">position_fill</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="number_formats.html">percent100</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>, color <span class="op">=</span> <span class="va">lbl_color</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>            position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_stack.html" class="external-link">position_fill</a></span><span class="op">(</span>vjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, fontface <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_identity.html" class="external-link">scale_color_identity</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">resp_pal</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="contrast_colors-5.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Camille Seaberry.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

