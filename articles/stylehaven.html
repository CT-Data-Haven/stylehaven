<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>stylehaven: Getting started • stylehaven</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="stylehaven_files/libs/quarto-html/popper.min.js"></script><script src="stylehaven_files/libs/quarto-html/tippy.umd.min.js"></script><link href="stylehaven_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="stylehaven_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="stylehaven: Getting started">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">stylehaven</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/stylehaven.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CT-Data-Haven/stylehaven/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>stylehaven: Getting started</h1>




      <small class="dont-index">Source: <a href="https://github.com/CT-Data-Haven/stylehaven/blob/main/vignettes/stylehaven.qmd" class="external-link"><code>vignettes/stylehaven.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/CT-Data-Haven/stylehaven" class="external-link">stylehaven</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
</div>
<p>This is a roundup of many of the functions in <code>stylehaven</code>, giving a simplified version of some of the charts we’ve published.</p>
<section class="level2"><h2 id="color-and-styling">Color and styling<a class="anchor" aria-label="anchor" href="#color-and-styling"></a>
</h2>
<p>Illustrates:</p>
<ul>
<li>Creating multiple weights of a font to use across all charts with <code>font_add_weights</code>
</li>
<li>Creating an array of color palettes based on a primary color</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/font_add_weights.html">font_add_weights</a></span><span class="op">(</span><span class="st">"Barlow Semi Condensed"</span>, semibold <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span><span class="co">#&gt; ℹ Registering the following fonts:</span></span>
<span><span class="co">#&gt; • Barlow Semi Condensed with regular weight 400 and bold weight 700</span></span>
<span><span class="co">#&gt; • Barlow Semi Condensed Semibold with semibold weight 500 and black weight 900</span></span>
<span></span>
<span><span class="va">base_col</span> <span class="op">&lt;-</span> <span class="st">"#287FC8"</span></span>
<span><span class="va">palx_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/palx.html">palx</a></span><span class="op">(</span><span class="va">base_col</span>, n_shades <span class="op">=</span> <span class="fl">6</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="stylehaven_files/figure-html/style-1.png" width="750"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qual_pal</span> <span class="op">&lt;-</span> <span class="va">palx_colors</span><span class="op">[[</span><span class="st">"shade04"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co"># use with offset labels to make white labels inside bars, dark gray labels outside</span></span>
<span><span class="va">tf_pal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TRUE"</span> <span class="op">=</span> <span class="va">palx_colors</span><span class="op">[[</span><span class="st">"shade02"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"gray"</span><span class="op">]</span><span class="op">]</span>, <span class="st">"FALSE"</span> <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
</div>
<p>This is a good time to check the contrast between the colors in this palette and the dark and light colors I might use for labels. <code><a href="../reference/contrast_colors.html">contrast_colors()</a></code> helps make sure your background and text colors have enough contrast to be legible for readers with low vision. If none of the color combinations have enough contrast and <code>verbose = TRUE</code>, you’ll get diagnostic messages pointing you to which contrast ratios you should work to increase (there’s an example of this in the docs).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dark_gray</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">palx_colors</span><span class="op">[[</span><span class="st">"shade01"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="st">"gray"</span><span class="op">]</span><span class="op">)</span> <span class="co"># super dark tinted gray</span></span>
<span><span class="fu"><a href="../reference/contrast_colors.html">contrast_colors</a></span><span class="op">(</span><span class="va">qual_pal</span>,</span>
<span>    dark <span class="op">=</span> <span class="va">dark_gray</span>,</span>
<span>    light <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    labels_only <span class="op">=</span> <span class="cn">FALSE</span>, plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="stylehaven_files/figure-html/contrast-1.png" width="1050"></p>
</figure>
</div>
</div>
<pre><code><span><span class="co">#&gt;      fill  dark light   max lbl_color low_contrast</span></span>
<span><span class="co">#&gt; 1 #DC50BE  5.04  3.54  5.04   #15181B        FALSE</span></span>
<span><span class="co">#&gt; 2 #DC5050  4.50  3.96  4.50   #15181B        FALSE</span></span>
<span><span class="co">#&gt; 3 #DC9650  7.23  2.46  7.23   #15181B        FALSE</span></span>
<span><span class="co">#&gt; 4 #B4DC50 11.28  1.58 11.28   #15181B        FALSE</span></span>
<span><span class="co">#&gt; 5 #50DC59  9.95  1.79  9.95   #15181B        FALSE</span></span>
<span><span class="co">#&gt; 6 #50DCC8 10.53  1.69 10.53   #15181B        FALSE</span></span>
<span><span class="co">#&gt; 7 #5082DC  4.72  3.77  4.72   #15181B        FALSE</span></span>
<span><span class="co">#&gt; 8 #8C50DC  3.65  4.89  4.89     white        FALSE</span></span>
<span><span class="co">#&gt; 9 #8997A3  5.96  2.99  5.96   #15181B        FALSE</span></span></code></pre>
</div>
<p>After a bit of tweaking, all the colors in this palette have a label color that is sufficiently high-contrast.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theme_bar</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_gray</a></span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"Barlow Semi Condensed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>            plot.caption.position <span class="op">=</span> <span class="st">"plot"</span>,</span>
<span>            plot.title.position <span class="op">=</span> <span class="st">"plot"</span>,</span>
<span>            strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span></span>
<span>                family <span class="op">=</span> <span class="st">"Barlow Semi Condensed Semibold"</span>,</span>
<span>                face <span class="op">=</span> <span class="st">"plain"</span>, hjust <span class="op">=</span> <span class="fl">0</span></span>
<span>            <span class="op">)</span>,</span>
<span>            panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span>, color <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>            axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu">theme_bar</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/update_defaults.html" class="external-link">update_geom_defaults</a></span><span class="op">(</span><span class="st">"col"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">base_col</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/update_defaults.html" class="external-link">update_geom_defaults</a></span><span class="op">(</span><span class="st">"text"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    size <span class="op">=</span> <span class="fl">3.5</span>, fontface <span class="op">=</span> <span class="st">"bold"</span>,</span>
<span>    family <span class="op">=</span> <span class="st">"Barlow Semi Condensed"</span>, color <span class="op">=</span> <span class="st">"white"</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mini_pal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="va">palx_colors</span><span class="op">[[</span><span class="st">"shade01"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="st">"gray"</span><span class="op">]</span>,</span>
<span>    <span class="va">palx_colors</span><span class="op">[[</span><span class="st">"shade03"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="st">"gray"</span><span class="op">]</span>,</span>
<span>    <span class="va">qual_pal</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"orange"</span>, <span class="st">"red"</span>, <span class="st">"indigo"</span>, <span class="st">"blue"</span>, <span class="st">"teal"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<p>I’ll keep all the plots in one named list, and all their output parameters (width &amp; height, could also include something like logo placement) in another named list. Then I’ll map over these to save all the plots as PDF and PNG. Having a list of widths &amp; heights also makes it easier to have the same dimensions within this document (as chunk <code>fig-width</code> and <code>fig-height</code>) as they have once they’re exported.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">plot_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    health_split <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>w <span class="op">=</span> <span class="fl">7</span>, h <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    health_stack <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>w <span class="op">=</span> <span class="fl">7</span>, h <span class="op">=</span> <span class="fl">4.5</span><span class="op">)</span>,</span>
<span>    age_heatmap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>w <span class="op">=</span> <span class="fl">4.5</span>, h <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="level2"><h2 id="facetted-bar-chart">Facetted bar chart<a class="anchor" aria-label="anchor" href="#facetted-bar-chart"></a>
</h2>
<p>Illustrates:</p>
<ul>
<li>Offsetting labels across multiple scales with <code>offset_lbls</code>
</li>
<li>String formatting functions</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># using just last 5 colors from mini_pal</span></span>
<span><span class="va">health_to_plot1</span> <span class="op">&lt;-</span> <span class="va">self_rated_health</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">response</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/offset_lbls.html">offset_lbls</a></span><span class="op">(</span>value <span class="op">=</span> <span class="va">value</span>, thresh <span class="op">=</span> <span class="fl">0.5</span>, fun <span class="op">=</span> <span class="va">percent100</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">health_to_plot1</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 9</span></span>
<span><span class="co">#&gt; # Groups:   response [5]</span></span>
<span><span class="co">#&gt;   category group       response  value is_small     off value_off  just lbl  </span></span>
<span><span class="co">#&gt;   &lt;fct&gt;    &lt;fct&gt;       &lt;fct&gt;     &lt;dbl&gt; &lt;lgl&gt;      &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt; 1 Total    Connecticut Excellent  0.19 FALSE    -0.01       0.18      1 19%  </span></span>
<span><span class="co">#&gt; 2 Total    Connecticut Very good  0.34 FALSE    -0.017      0.323     1 34%  </span></span>
<span><span class="co">#&gt; 3 Total    Connecticut Good       0.29 FALSE    -0.0185     0.271     1 29%  </span></span>
<span><span class="co">#&gt; 4 Total    Connecticut Fair       0.14 FALSE    -0.011      0.129     1 14%  </span></span>
<span><span class="co">#&gt; 5 Total    Connecticut Poor       0.04 TRUE      0.009      0.049     0 4%   </span></span>
<span><span class="co">#&gt; 6 Gender   Male        Excellent  0.2  FALSE    -0.01       0.19      1 20%</span></span>
<span></span>
<span><span class="va">plots</span><span class="op">[[</span><span class="st">"health_split"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">health_to_plot1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, y <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html" class="external-link">fct_rev</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">lbl</span>, x <span class="op">=</span> <span class="va">value_off</span>, hjust <span class="op">=</span> <span class="va">just</span>, color <span class="op">=</span> <span class="va">is_small</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/scale_barcontinuous.html">scale_x_barcontinuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">tf_pal</span>, guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_none.html" class="external-link">guide_none</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html" class="external-link">fct_rev</a></span><span class="op">(</span><span class="va">response</span><span class="op">)</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free"</span>, space <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.spacing.x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="st">"lines"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        title <span class="op">=</span> <span class="st">"Nonbinary adults are much less likely to report being in very good or excellent health"</span>,</span>
<span>        subtitle <span class="op">=</span> <span class="st">"Share of adults by gender and response to self-rated health, Connecticut, 2024"</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">plots</span><span class="op">[[</span><span class="st">"health_split"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="stylehaven_files/figure-html/health-split-1.png" width="1050"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h2 id="labeling-endpoints">Labeling endpoints<a class="anchor" aria-label="anchor" href="#labeling-endpoints"></a>
</h2>
<p><code>endpoint_lbls</code> adds columns for labels that are offset slightly to the left for the lower limit and to the right for the upper limit, a corresponding hjust value to align left-hand labels at the end of the string and right-hand labels at the start of the string, and labels to use that include the grouping variable on one or both sides. This encourages direct labeling to wean yourself away from legends.</p>
<p>One thing to deal with here is the margins of the plot: You can set padding with <code>expansion</code>, but that changes the limits of the scale as well, so you might need to adjust your breaks. That’s easy enough for slopegraphs like this but could get annoying if you don’t know exactly what the breaks will need to be.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">police_trend_to_plot</span> <span class="op">&lt;-</span> <span class="va">cws_trend</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">question</span> <span class="op">==</span> <span class="st">"police_approval"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/endpoint_lbls.html">endpoint_lbls</a></span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="va">year</span>, value <span class="op">=</span> <span class="va">value</span>, group <span class="op">=</span> <span class="va">group</span>,</span>
<span>        fun <span class="op">=</span> <span class="va">percent100</span>, long_side <span class="op">=</span> <span class="st">"left"</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">police_trend_to_plot</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 8</span></span>
<span><span class="co">#&gt;   question         year category group             value     x  just lbl        </span></span>
<span><span class="co">#&gt;   &lt;fct&gt;           &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;             &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;      </span></span>
<span><span class="co">#&gt; 1 police_approval  2015 Total    Connecticut        0.78 2015.     1 Connecticu…</span></span>
<span><span class="co">#&gt; 2 police_approval  2015 Total    Greater New Haven  0.74 2015.     1 Greater Ne…</span></span>
<span><span class="co">#&gt; 3 police_approval  2015 Age      Ages 18-34         0.69 2015.     1 Ages 18-34…</span></span>
<span><span class="co">#&gt; 4 police_approval  2015 Age      Ages 35-49         0.7  2015.     1 Ages 35-49…</span></span>
<span><span class="co">#&gt; 5 police_approval  2015 Age      Ages 50-64         0.77 2015.     1 Ages 50-64…</span></span>
<span><span class="co">#&gt; 6 police_approval  2015 Age      Ages 65+           0.81 2015.     1 Ages 65+: …</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://ggrepel.slowkow.com/" class="external-link">"ggrepel"</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">police_trend_to_plot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">value</span>, color <span class="op">=</span> <span class="va">group</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="co"># set text positions with calculated offsets</span></span>
<span>        <span class="co"># geom_text(aes(label = lbl, x = x, hjust = just)) +</span></span>
<span>        <span class="co"># better to use ggrepel to not overlap labels</span></span>
<span>        <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">geom_text_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">lbl</span>, x <span class="op">=</span> <span class="va">x</span>, hjust <span class="op">=</span> <span class="va">just</span><span class="op">)</span>,</span>
<span>            seed <span class="op">=</span> <span class="fl">10</span>,</span>
<span>            size <span class="op">=</span> <span class="fl">3.5</span>, fontface <span class="op">=</span> <span class="st">"bold"</span>, direction <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>            family <span class="op">=</span> <span class="st">"Barlow Semi Condensed"</span>, box.padding <span class="op">=</span> <span class="fl">0.15</span></span>
<span>        <span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expansion.html" class="external-link">expansion</a></span><span class="op">(</span>add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2015</span>, <span class="fl">2024</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">mini_pal</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>            legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>            panel.grid.major.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>            x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>            title <span class="op">=</span> <span class="st">"Approval of police has fallen among all but the oldest adults"</span>,</span>
<span>            subtitle <span class="op">=</span> <span class="st">"Share of Greater New Haven adults, 2015-2024"</span></span>
<span>        <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="stylehaven_files/figure-html/assets-trend-1.png" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>If I want to switch sides for the long label (<code>long_side</code> argument in <code>endpoint_lbls</code>), the only thing I need to change is the padding on the x-axis—everything else is in the data frame.</p>
<p>For just a few lines, full labels on just the left or right is fine, but there’s also the option to add labels on both sides, which can help make more lines easier to read</p>
</section><section class="level2"><h2 id="separating-squished-labels">Separating squished labels<a class="anchor" aria-label="anchor" href="#separating-squished-labels"></a>
</h2>
<p>Dot plots with points directly labeled are great until the values are too close together, and then it’s a pain to keep the labels from overlapping. One nice way to handle this is to calculate the distance between points on each line (whatever’s the independent variable) and offset labels that are within some threshold of any other label. The data frame this returns can be used with <code>semi_join</code> and <code>anti_join</code> to make 2 calls to <code>geom_text</code>/<code>geom_text_repel</code>. The argument <code>thresh = 0.5</code> means values with a difference of 0.5 will be considered too close; this is an absolute value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hartford_age</span> <span class="op">&lt;-</span> <span class="va">median_age</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html" class="external-link">as_factor</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Connecticut"</span>, <span class="st">"Capitol COG"</span>, <span class="st">"Hartford"</span>, <span class="st">"New Britain"</span>, <span class="st">"West Hartford"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">age_to_dodge</span> <span class="op">&lt;-</span> <span class="va">hartford_age</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/dodge_lbls.html">dodge_lbls</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sex</span>, value <span class="op">=</span> <span class="va">value</span>, group <span class="op">=</span> <span class="va">name</span>, thresh <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">hartford_age</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, y <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html" class="external-link">fct_rev</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span>, color <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span>, alpha <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># labels that don't need dodging</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">value</span><span class="op">)</span>,</span>
<span>        data <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html" class="external-link">anti_join</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">age_to_dodge</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sex"</span>, <span class="st">"name"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        color <span class="op">=</span> <span class="st">"white"</span>, size <span class="op">=</span> <span class="fl">3.2</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># labels that do need dodging</span></span>
<span>    <span class="fu">ggrepel</span><span class="fu">::</span><span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">geom_text_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">value</span><span class="op">)</span>,</span>
<span>        data <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html" class="external-link">semi_join</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">age_to_dodge</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sex"</span>, <span class="st">"name"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        seed <span class="op">=</span> <span class="fl">1</span>, direction <span class="op">=</span> <span class="st">"x"</span>, nudge_y <span class="op">=</span> <span class="fl">0.35</span>,</span>
<span>        family <span class="op">=</span> <span class="st">"Barlow Semi Condensed"</span>, fontface <span class="op">=</span> <span class="st">"bold"</span>,</span>
<span>        size <span class="op">=</span> <span class="fl">3.2</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span></span>
<span>        values <span class="op">=</span> <span class="va">mini_pal</span>,</span>
<span>        guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_y_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">title_case</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid.major.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span>, color <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        title <span class="op">=</span> <span class="st">"Median age by sex"</span>,</span>
<span>        subtitle <span class="op">=</span> <span class="st">"Median age in years, Hartford area, 2023"</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="stylehaven_files/figure-html/hartford-age-1.png" width="1050"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h2 id="stacking-labels">Stacking labels<a class="anchor" aria-label="anchor" href="#stacking-labels"></a>
</h2>
<p>Positioning stacked labels is often simple enough with <code>position_stack</code> or <code>position_fill</code>, but sometimes you need more tailored placement. Some reasons are making labels alongside stacked bars to replace a legend, or for situations where some values are very small and need labels to be offset. <code>stack_lbls</code> calculates the placement for labels at some proportion within a bar. Because this is based on cumulative sums, take care of how the data are arranged.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">health_to_plot2</span> <span class="op">&lt;-</span> <span class="va">self_rated_health</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>response <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html" class="external-link">fct_rev</a></span><span class="op">(</span><span class="va">response</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">response</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>stack <span class="op">=</span> <span class="fu"><a href="../reference/stack_lbls.html">stack_lbls</a></span><span class="op">(</span><span class="va">value</span>, fill <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">health_to_plot2</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span><span class="co">#&gt;   category group       response  value stack</span></span>
<span><span class="co">#&gt;   &lt;fct&gt;    &lt;fct&gt;       &lt;fct&gt;     &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 Total    Connecticut Poor       0.04 0.02 </span></span>
<span><span class="co">#&gt; 2 Total    Connecticut Fair       0.14 0.11 </span></span>
<span><span class="co">#&gt; 3 Total    Connecticut Good       0.29 0.325</span></span>
<span><span class="co">#&gt; 4 Total    Connecticut Very good  0.34 0.64 </span></span>
<span><span class="co">#&gt; 5 Total    Connecticut Excellent  0.19 0.905</span></span>
<span><span class="co">#&gt; 6 Gender   Male        Poor       0.04 0.02</span></span>
<span></span>
<span><span class="va">plots</span><span class="op">[[</span><span class="st">"health_stack"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">health_to_plot2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">response</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.8</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_stack.html" class="external-link">position_fill</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="../reference/number_formats.html">percent100</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">stack</span><span class="op">)</span>,</span>
<span>        color <span class="op">=</span> <span class="va">dark_gray</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">mini_pal</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span>, guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>reverse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="../reference/scale_barcontinuous.html">scale_y_barcontinuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span>, fill <span class="op">=</span> <span class="st">"Response"</span>,</span>
<span>        title <span class="op">=</span> <span class="st">"Self-rated health by gender"</span>,</span>
<span>        subtitle <span class="op">=</span> <span class="st">"Share of adults, Connecticut, 2024"</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">plots</span><span class="op">[[</span><span class="st">"health_stack"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="stylehaven_files/figure-html/health-stack-1.png" width="1050"></p>
</figure>
</div>
</div>
</div>
<p>Those bottom bars are really small; for smaller bars or larger labels, I might offset those small ones to the side.</p>
</section><section class="level2"><h2 id="standard-deviation-breaks">Standard deviation breaks<a class="anchor" aria-label="anchor" href="#standard-deviation-breaks"></a>
</h2>
<p>Sometimes for tables or dense grids of plots, we color things based on how many standard deviations away from a mean each value is. <code>stdev_brks</code> does this, either by calculating a mean or filtering for some other comparison value, like a statewide value in the data. In this case I’ll compare towns’ median ages by sex against the state’s overall median age. It’s not a very useful chart but it illustrates the function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">div_pal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#0060B8"</span>, <span class="st">"#649EE6"</span>, <span class="st">"#C9C9C9"</span>, <span class="st">"#D48A50"</span>, <span class="st">"#944800"</span><span class="op">)</span></span>
<span><span class="va">age_std</span> <span class="op">&lt;-</span> <span class="va">median_age</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/stdev_brks.html">stdev_brks</a></span><span class="op">(</span></span>
<span>        value <span class="op">=</span> <span class="va">value</span>,</span>
<span>        filters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Connecticut"</span>, sex <span class="op">=</span> <span class="st">"total"</span><span class="op">)</span>,</span>
<span>        labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Much younger"</span>, <span class="st">"Younger"</span>, <span class="st">"Similar to COG"</span>, <span class="st">"Older"</span>, <span class="st">"Much older"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">age_std</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 9</span></span>
<span><span class="co">#&gt;   level  county name        sex    value midpt    sd       z brk           </span></span>
<span><span class="co">#&gt;   &lt;fct&gt;  &lt;chr&gt;  &lt;chr&gt;       &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt;         </span></span>
<span><span class="co">#&gt; 1 state  &lt;NA&gt;   Connecticut total   41.2  41.2  5.16  0      Similar to COG</span></span>
<span><span class="co">#&gt; 2 state  &lt;NA&gt;   Connecticut male    39.8  41.2  5.16 -0.271  Similar to COG</span></span>
<span><span class="co">#&gt; 3 state  &lt;NA&gt;   Connecticut female  42.5  41.2  5.16  0.252  Similar to COG</span></span>
<span><span class="co">#&gt; 4 county &lt;NA&gt;   Capitol COG total   40.2  41.2  5.16 -0.194  Similar to COG</span></span>
<span><span class="co">#&gt; 5 county &lt;NA&gt;   Capitol COG male    38.7  41.2  5.16 -0.484  Similar to COG</span></span>
<span><span class="co">#&gt; 6 county &lt;NA&gt;   Capitol COG female  41.7  41.2  5.16  0.0969 Similar to COG</span></span>
<span></span>
<span><span class="co"># for simplicity, just plot Greater Bridgeport towns</span></span>
<span><span class="va">plots</span><span class="op">[[</span><span class="st">"age_heatmap"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">age_std</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">county</span> <span class="op">==</span> <span class="st">"Capitol COG"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html" class="external-link">as_factor</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_reorder.html" class="external-link">fct_reorder2</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span>, <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sex</span>, y <span class="op">=</span> <span class="va">name</span>, fill <span class="op">=</span> <span class="va">brk</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">dark_gray</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># rcartocolor::scale_fill_carto_d(palette = "Geyser") +</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">div_pal</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">title_case</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span>, fill <span class="op">=</span> <span class="st">"Compared to CT..."</span>,</span>
<span>        title <span class="op">=</span> <span class="st">"Median age by town and sex"</span>,</span>
<span>        subtitle <span class="op">=</span> <span class="st">"Capitol COG towns compared to statewide, 2023"</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">plots</span><span class="op">[[</span><span class="st">"age_heatmap"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="stylehaven_files/figure-html/age-heatmap-1.png" width="675"></p>
</figure>
</div>
</div>
</div>
</section><section class="level2"><h2 id="tables-more-string-formatting">Tables &amp; more string formatting<a class="anchor" aria-label="anchor" href="#tables-more-string-formatting"></a>
</h2>
<p>I’ve beefed up the string formatting functions and added a few that help with making tables, especially for HTML or narrative output. These functions plus <code>glue</code> are the secret behind the town equity reports’ text.</p>
<div class="sourceCode cell-code" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">govt_to_text</span> <span class="op">&lt;-</span> <span class="va">cws_trend</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2024</span>, <span class="va">question</span> <span class="op">==</span> <span class="st">"local_govt_responsive"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">value</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html" class="external-link">deframe</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span></span>
<span>    <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html" class="external-link">str_glue</a></span><span class="op">(</span><span class="st">"&gt; In 2024, {percent_txt(govt_to_text['Connecticut'])} of Connecticut</span></span>
<span><span class="st">                    adults felt their local police did a good job to keep</span></span>
<span><span class="st">                    residents safe, compared to</span></span>
<span><span class="st">                    {percent_txt(govt_to_text['Greater New Haven'])} of</span></span>
<span><span class="st">                    Greater New Haven adults.</span></span>
<span><span class="st">                    {percent_eng(govt_to_text['Ages 18-34'])} of Greater</span></span>
<span><span class="st">                    New Haven adults ages 18 to 34 reported the same."</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p>In 2024, 51 percent of Connecticut adults felt their local police did a good job to keep residents safe, compared to 48 percent of Greater New Haven adults. Thirty-two percent of Greater New Haven adults ages 18 to 34 reported the same.</p>
</blockquote>
<p>This is an over-engineered example of dynamically aligning table columns based on the data, but it’s helpful for bigger tables or where different versions of a table might have different sets of columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cws_to_tbl</span> <span class="op">&lt;-</span> <span class="va">cws_trend</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2024</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>id_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">category</span>, <span class="va">group</span><span class="op">)</span>, names_from <span class="op">=</span> <span class="va">question</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cws_to_tbl</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 5</span></span>
<span><span class="co">#&gt;   category group             local_govt_responsive police_approval good_parks</span></span>
<span><span class="co">#&gt;   &lt;fct&gt;    &lt;fct&gt;                             &lt;dbl&gt;           &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 Total    Connecticut                        0.51            0.72       0.74</span></span>
<span><span class="co">#&gt; 2 Total    Greater New Haven                  0.48            0.65       0.71</span></span>
<span><span class="co">#&gt; 3 Age      Ages 18-34                         0.32            0.46       0.62</span></span>
<span><span class="co">#&gt; 4 Age      Ages 35-49                         0.44            0.62       0.67</span></span>
<span><span class="co">#&gt; 5 Age      Ages 50-64                         0.52            0.72       0.74</span></span>
<span><span class="co">#&gt; 6 Age      Ages 65+                           0.67            0.84       0.86</span></span>
<span></span>
<span><span class="co"># imagine I'm not sure how many left-aligned (categorical) columns there will be,</span></span>
<span><span class="co"># but I can calculate the number of right-aligned (numeric) columns based on the</span></span>
<span><span class="co"># question levels</span></span>
<span><span class="va">cws_align</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/align_cols.html">align_cols</a></span><span class="op">(</span></span>
<span>    r <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">cws_trend</span><span class="op">$</span><span class="va">question</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">cws_to_tbl</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cws_to_tbl</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>        local_govt_is_responsive <span class="op">=</span> <span class="va">local_govt_responsive</span>,</span>
<span>        approve_of_police <span class="op">=</span> <span class="va">police_approval</span>,</span>
<span>        parks_in_good_condition <span class="op">=</span> <span class="va">good_parks</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename_with</a></span><span class="op">(</span><span class="va">title_case</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html" class="external-link">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="va">percent100</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>align <span class="op">=</span> <span class="va">cws_align</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<table class="table caption-top">
<colgroup>
<col style="width: 9%">
<col style="width: 19%">
<col style="width: 26%">
<col style="width: 19%">
<col style="width: 25%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Category</th>
<th style="text-align: left;">Group</th>
<th style="text-align: right;">Local Govt Is Responsive</th>
<th style="text-align: right;">Approve of Police</th>
<th style="text-align: right;">Parks in Good Condition</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: left;">Connecticut</td>
<td style="text-align: right;">51%</td>
<td style="text-align: right;">72%</td>
<td style="text-align: right;">74%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Total</td>
<td style="text-align: left;">Greater New Haven</td>
<td style="text-align: right;">48%</td>
<td style="text-align: right;">65%</td>
<td style="text-align: right;">71%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Age</td>
<td style="text-align: left;">Ages 18-34</td>
<td style="text-align: right;">32%</td>
<td style="text-align: right;">46%</td>
<td style="text-align: right;">62%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Age</td>
<td style="text-align: left;">Ages 35-49</td>
<td style="text-align: right;">44%</td>
<td style="text-align: right;">62%</td>
<td style="text-align: right;">67%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Age</td>
<td style="text-align: left;">Ages 50-64</td>
<td style="text-align: right;">52%</td>
<td style="text-align: right;">72%</td>
<td style="text-align: right;">74%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Age</td>
<td style="text-align: left;">Ages 65+</td>
<td style="text-align: right;">67%</td>
<td style="text-align: right;">84%</td>
<td style="text-align: right;">86%</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section class="level2"><h2 id="batch-writing-image-files">Batch writing image files<a class="anchor" aria-label="anchor" href="#batch-writing-image-files"></a>
</h2>
<p>Batch image functions came about after exporting thousands of plots for the equity reports, as a way to go from the above lists of plots and plot parameters and not have to think about how to write all those plots out, adding &amp; scaling logos.</p>
<p>By default, this will add a logo (using <code><a href="../reference/add_logo.html">stylehaven::add_logo</a></code>) and adjust the height of the plot to fit so that the aspect ratio stays the same even after appending the logo to the bottom of the image.</p>
<p>Writing out one plot (by default, both PNG &amp; PDF):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"plots"</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.exists</a></span><span class="op">(</span><span class="va">out_dir</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">out_dir</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/write_plot.html">write_plot</a></span><span class="op">(</span><span class="va">plots</span><span class="op">[[</span><span class="st">"health_split"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    filename <span class="op">=</span> <span class="st">"health_split"</span>, add_logo <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    dir <span class="op">=</span> <span class="va">out_dir</span>,</span>
<span>    width <span class="op">=</span> <span class="va">plot_params</span><span class="op">[[</span><span class="st">"health_split"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">w</span>,</span>
<span>    height <span class="op">=</span> <span class="va">plot_params</span><span class="op">[[</span><span class="st">"health_split"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">h</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">out_dir</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "pdf/health_split.pdf" "png/health_split.png"</span></span></code></pre></div>
</div>
<p>Even better, iterating over the plots and plot params to write all the plots. One thing to note here is to be careful that you’re matching plots and params if they’re in separate lists: you might get messed up if these lists are out of order, even if they’re named. (This once bothered me enough to post a <a href="https://stackoverflow.com/q/55798573/5325862" class="external-link">question on Stack Overflow</a>.) You can map over one list and use its names to pull entries out of the other list.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/imap.html" class="external-link">iwalk</a></span><span class="op">(</span><span class="va">plots</span>, <span class="kw">function</span><span class="op">(</span><span class="va">pl</span>, <span class="va">id</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">ps</span> <span class="op">&lt;-</span> <span class="va">plot_params</span><span class="op">[[</span><span class="va">id</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="../reference/write_plot.html">write_plot</a></span><span class="op">(</span><span class="va">pl</span>,</span>
<span>        filename <span class="op">=</span> <span class="va">id</span>, add_logo <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        dir <span class="op">=</span> <span class="va">out_dir</span>, width <span class="op">=</span> <span class="va">ps</span><span class="op">$</span><span class="va">w</span>, height <span class="op">=</span> <span class="va">ps</span><span class="op">$</span><span class="va">h</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">out_dir</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "pdf/age_heatmap.pdf"  "pdf/health_split.pdf" "pdf/health_stack.pdf"</span></span>
<span><span class="co">#&gt; [4] "png/age_heatmap.png"  "png/health_split.png" "png/health_stack.png"</span></span></code></pre></div>
</div>
</section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Camille Seaberry.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
